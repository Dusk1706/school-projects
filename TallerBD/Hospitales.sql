CREATE DATABASE HOSPITALES
GO 
USE HOSPITALES
GO
--CREACION DE TABLAS
CREATE TABLE HOSPITALES(
    HOSPID INT NOT NULL,
    HOSPNOMBRE NVARCHAR (50) NOT NULL,
    HOSPTELEFONO NCHAR (10) NOT NULL,
    HOSPDOMICILIO NVARCHAR (100) NOT NULL
)
GO
CREATE TABLE CONSULTORIOS(
    CONSID INT NOT NULL,
    CONSNOMBRE NVARCHAR(50) NOT NULL,
    HOSPID INT NOT NULL
)
GO
CREATE TABLE LABORATORIOS(
    LABID INT NOT NULL,
    LABNOMBRE NVARCHAR (50) NOT NULL
)
GO
CREATE TABLE MEDICAMENTOS(
    MEDID INT NOT NULL,
    MEDNOMBRE NVARCHAR (50) NOT NULL,
    MEDPRECIO NUMERIC(10,2) NOT NULL,
    MEDSUSACTIVA NVARCHAR (50) NOT NULL,
    LABID INT NOT NULL
)
GO
CREATE TABLE PACIENTES(
    PACID INT NOT NULL,
    PACNOMBRE NVARCHAR (50) NOT NULL,
    PACAPEPAT NVARCHAR (50) NOT NULL,
    PACAPEMAT NVARCHAR (50) NULL,
    PACSEXO NCHAR(1) NOT NULL,
    PACNSS NCHAR(9) NOT NULL,
    PACTELEFONO NCHAR (10) NULL,
    PACFECHNAC DATETIME NOT NULL,
    PACDOMICILIO NVARCHAR (100) NULL
)
GO
CREATE TABLE DOCTORES(
    DOCID INT NOT NULL,
    DOCNOMBRE NVARCHAR (50) NOT NULL,
    DOCAPEPAT NVARCHAR (50) NOT NULL,
    DOCAPEMAT NVARCHAR (50) NULL,
    DOCTELEFONO NCHAR (10) NULL,
    DOCDOMICILIO NVARCHAR (100) NOT NULL,
    DOCFECHNAC DATETIME NOT NULL,
    DOCCURP NCHAR(18) NOT NULL,
    DOCRFC NCHAR(13) NOT NULL
)
GO
CREATE TABLE ESPECIALIDADES(
    ESPID INT NOT NULL,
    ESPNOMBRE NVARCHAR (50) NOT NULL
)
GO
CREATE TABLE DOCTORESXESP(
    DOCID INT NOT NULL,
    ESPID INT NOT NULL
)

GO
CREATE TABLE CITAS(
    CITID INT NOT NULL,
    CITFECHA DATETIME NOT NULL,
    CITPRESION INT NOT NULL,
    CITPESO NUMERIC (5, 2) NOT NULL,
    CITALTURA NUMERIC (5, 2) NOT NULL,
    CITSINTOMAS NVARCHAR (150) NOT NULL,
    CITDIAGNOSTICO NVARCHAR (250) NOT NULL,
    CONSID INT NOT NULL,
    DOCID INT NOT NULL,
    PACID INT NOT NULL
)
GO
CREATE TABLE RECETAS(
    RECDOSIS NVARCHAR (50) NOT NULL,
    MEDID INT NOT NULL,
    CITID INT NOT NULL
)
GO
--CREACION DE LLAVES PRIMARIAS
ALTER TABLE HOSPITALES ADD CONSTRAINT PK_HOSPITALES PRIMARY KEY(HOSPID)
ALTER TABLE CONSULTORIOS ADD CONSTRAINT PK_CONSULTORIOS PRIMARY KEY (CONSID)
ALTER TABLE LABORATORIOS ADD CONSTRAINT PK_LABORATORIOS PRIMARY KEY (LABID)
ALTER TABLE MEDICAMENTOS ADD CONSTRAINT PK_MEDICAMENTOS PRIMARY KEY (MEDID)
ALTER TABLE PACIENTES ADD CONSTRAINT PK_PACIENTES PRIMARY KEY (PACID)
ALTER TABLE DOCTORES ADD CONSTRAINT PK_DOCTORES PRIMARY KEY (DOCID)
ALTER TABLE ESPECIALIDADES ADD CONSTRAINT PK_ESPECIALIDAD PRIMARY KEY (ESPID)
ALTER TABLE CITAS ADD CONSTRAINT PK_CITAS PRIMARY KEY (CITID)

--CREACION DE LLAVES EXTERNAS
ALTER TABLE CITAS ADD 
CONSTRAINT FK_CITAS_PACIENTES FOREIGN KEY (PACID) REFERENCES PACIENTES (PACID),
CONSTRAINT FK_CITAS_CONSULTORIOS FOREIGN KEY (CONSID) REFERENCES CONSULTORIOS(CONSID),
CONSTRAINT FK_CITAS_DOCTOR FOREIGN KEY (DOCID) REFERENCES DOCTORES(DOCID)

ALTER TABLE RECETAS ADD 
CONSTRAINT FK_RECETAS_CITAS FOREIGN KEY(CITID)REFERENCES CITAS(CITID),
CONSTRAINT FK_RECETAS_MEDICAMENTOS FOREIGN KEY(MEDID)REFERENCES MEDICAMENTOS(MEDID)

ALTER TABLE CONSULTORIOS ADD 
CONSTRAINT FK_CONSULTORIOS_HOSPITAL FOREIGN KEY(HOSPID)REFERENCES HOSPITALES(HOSPID)

ALTER TABLE MEDICAMENTOS ADD 
CONSTRAINT FK_MEDICAMENTOS_LABORATORIOS FOREIGN KEY(LABID)REFERENCES LABORATORIOS(LABID)

ALTER TABLE DOCTORESXESP ADD 
CONSTRAINT FK_DOCTORESXESP_DOCTORES FOREIGN KEY(DOCID)REFERENCES DOCTORES(DOCID),
CONSTRAINT FK_DOCTORESXESP_ESPECIALIDADES FOREIGN KEY(ESPID)REFERENCES ESPECIALIDADES(ESPID)


--LLAVES UNICAS
ALTER TABLE PACIENTES ADD CONSTRAINT UN_NSS_PAC UNIQUE(PACNSS)
ALTER TABLE DOCTORES ADD 
CONSTRAINT UN_CURP_DOC UNIQUE(DOCCURP),
CONSTRAINT UN_RFC_DOC UNIQUE(DOCRFC)
GO
--RESTRICCIONES DE COMPROBACION
ALTER TABLE PACIENTES ADD 
CONSTRAINT CC_PAC_SEXO CHECK(PACSEXO IN ('H','M'))

GO
ALTER TABLE DOCTORES ADD 
CONSTRAINT CC_DOC_RFC_CURP CHECK(DOCRFC<>DOCCURP)

--VALOR PREDEFINIDO
ALTER TABLE PACIENTES ADD
CONSTRAINT DC_PAC_DOM DEFAULT('DOMICILIO DESCONOCIDO')FOR PACDOMICILIO,
CONSTRAINT DC_PAC_TEL DEFAULT('SIN TELEFONO')FOR PACTELEFONO
GO
ALTER TABLE DOCTORES ADD 
CONSTRAINT DC_DOCTORES_DOM DEFAULT('DOMICILIO DESCONOCIDO')FOR DOCDOMICILIO,
CONSTRAINT DC_DOCTORES_TEL DEFAULT('SIN TELEFONO')FOR DOCTELEFONO
GO
ALTER TABLE CITAS ADD
CONSTRAINT CC_REC_PESO CHECK(CITPESO>0),
CONSTRAINT CC_REC_PRESION CHECK(CITPRESION>0),
CONSTRAINT CC_REC_ALTURA CHECK(CITALTURA>0)
GO
--INSERCIONES 
INSERT HOSPITALES VALUES (1, 'Hospital Tigre','1234567890' ,'Lazaro cardenas, Ciudad')
INSERT HOSPITALES VALUES (2, 'Hospital Orca', '9876543210', 'Venustiano carranza, Ciudad')
INSERT HOSPITALES VALUES (3, 'Hospital Leon', '7555547455', 'Liverpool, Ciudad')
INSERT HOSPITALES VALUES (4, 'Hospital Mono', '1111781111', 'Carrillo, Ciudad')
INSERT HOSPITALES VALUES (5, 'Hospital Rinoceronte', '9999999999', 'Inturbide, Ciudad')
GO
INSERT CONSULTORIOS VALUES (1, 'Consultorio 1', 1)
INSERT CONSULTORIOS VALUES (2, 'Consultorio 2', 2)
INSERT CONSULTORIOS VALUES (3, 'Consultorio 3', 3)
INSERT CONSULTORIOS VALUES (4, 'Consultorio 4', 4)
INSERT CONSULTORIOS VALUES (5, 'Consultorio 5', 5)
GO
INSERT ESPECIALIDADES VALUES (1, 'Pediatria')
INSERT ESPECIALIDADES VALUES (2, 'Cardiologia')
INSERT ESPECIALIDADES VALUES (3, 'Ginecologia')
INSERT ESPECIALIDADES VALUES (4, 'Ortopedia')
INSERT ESPECIALIDADES VALUES (5, 'Dermatologia')
GO
INSERT PACIENTES VALUES (1, 'Benito', 'Cazares', 'Paez', 'H', '011462940', '6674747474', '8-24-2005', 'Carriño 4780')
INSERT PACIENTES VALUES (2, 'Pablo', 'Hera', 'Sojo', 'H', '409679333', '6665656565', '4-20-2000', 'Puntazul 4000')
INSERT PACIENTES VALUES (3, 'Luisa', 'Royal', 'Smith', 'M', '532054606', '6679999999', '5-14-1998', 'Mercadito 4736')
INSERT PACIENTES VALUES (4, 'Ana', 'Covarruvias', 'Higuera', 'M', '429416640', '6670000000', '6-10-1999', 'Lopes 4584')
INSERT PACIENTES VALUES (5, 'Erick', 'Pato', 'Gonzales', 'H', '040111291', '6671234567', '7-9-2005', 'Leopoldo 4788')
GO
INSERT DOCTORES VALUES (1, 'Dylan', 'Garcia', 'Figueroa', '6673489405', 'Quiñones 5874','6-17-2003','GAFD030617HSLRGYA5','GAFD030617HQ4')
INSERT DOCTORES VALUES (2, 'Pablo', 'Ponce', 'Lopez', '6673111115', 'Dunas 5725','10-19-2000','POLP001019HSLNPBA1','POLP001019QT2')
INSERT DOCTORES VALUES (3, 'Karina', 'Pinky', 'Gutierrez', '6673499999', 'Infonavit 4747','12-6-1995','PIGK951206MSLNTR07','PIGK951206Q53')
INSERT DOCTORES VALUES (4, 'Kevin', 'Rodriguez', 'lazaro', '6673457878', 'Lazaros 4758', '4-11-2000', 'ROLK000411HSLDZVA2', 'KERL000411NE2')
INSERT DOCTORES VALUES (5, 'Rodolfo', 'Berrelleza', 'Paz', '6673489562', 'Pancho Villa 9602', '11-23-1975', 'BEPR001123HSLRZDA0', 'ROBP751123B99')
GO
INSERT CITAS VALUES (1,'8-25-2019', 120.0, 70.0, 170.0, 'Fiebre y dolor de garganta', 'Amigdalitis', 1, 1, 1)
INSERT CITAS VALUES (2,'7-12-2019', 130.0, 65.0, 160.0, 'Dolor en el pecho', 'Arritmia cardíaca', 2, 2, 2)
INSERT CITAS VALUES (3,'6-5-2019', 110.0, 60.0, 180.0, 'Dolor abdominal', 'Apendicitis', 3, 3, 3)
INSERT CITAS VALUES (4,'5-15-2019', 115.0, 75.0, 190.0, 'Dolor en la muñeca', 'Fractura de muñeca', 4, 4, 4)
INSERT CITAS VALUES (5,'4-21-2019', 118.0, 72.0, 200.0, 'Picazón en la piel', 'Dermatitis', 5, 5, 5)
GO
INSERT LABORATORIOS VALUES (1, 'Laboratorio A')
INSERT LABORATORIOS VALUES (2, 'Laboratorio B')
INSERT LABORATORIOS VALUES (3, 'Laboratorio C')
INSERT LABORATORIOS VALUES (4, 'Laboratorio D')
INSERT LABORATORIOS VALUES (5, 'Laboratorio E')
GO
INSERT MEDICAMENTOS VALUES (1, 'Paracetamol', 45.00, 'Paracetamol', 1)
INSERT MEDICAMENTOS VALUES (2, 'Amoxicilina', 40.00, 'Amoxicilina', 2)
INSERT MEDICAMENTOS VALUES (3, 'Atorvastatina', 55.00, 'Atorvastatina', 3)
INSERT MEDICAMENTOS VALUES (4, 'Ibuprofeno', 50.00, 'Ibuprofeno', 4)
INSERT MEDICAMENTOS VALUES (5, 'Omeprazol', 70.00, 'Omeprazol', 5)
GO
INSERT DOCTORESXESP VALUES (1, 1)
INSERT DOCTORESXESP VALUES (2, 2)
INSERT DOCTORESXESP VALUES (3, 3)
INSERT DOCTORESXESP VALUES (4, 4)
INSERT DOCTORESXESP VALUES (5, 5)
GO
INSERT RECETAS VALUES ('500 mg cada 6 horas', 1, 1)
INSERT RECETAS VALUES ('250 mg cada 8 horas', 2, 2)
INSERT RECETAS VALUES ('1 tableta diaria', 3, 3)
INSERT RECETAS VALUES ('Inmovilización y fisioterapia', 4, 4)
INSERT RECETAS VALUES ('Aplicar crema dos veces al día', 5, 5)

